import { createClient } from '@supabase/supabase-js'

// Supabase配置
const supabaseUrl = 'https://vqcuwjfxoxjgsrueqodj.supabase.co'
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZxY3V3amZ4b3hqZ3NydWVxb2RqIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NzkwNzQ4NSwiZXhwIjoyMDczNDgzNDg1fQ.qgpIbHaGFv7-Coy165-LrFnjwR5DexWenrNf4f0P4YE'

const supabase = createClient(supabaseUrl, supabaseKey)

// 基於實際商家數據的準確答案
const accurateAnswers = {
  // 美食推薦 (12題)
  '附近有什麼好吃的餐廳？': '文山特區有很多不錯的餐廳選擇！我為您推薦幾家：スシロー壽司郎 高雄鳳山店（壽司）、一燒丼飯專賣（丼飯）、一魂 いざかや（居酒屋）、夜葉食堂鳳山店（日式料理）、食事處櫻廷（日式料理）等。這些都是我精挑細選的優質店家，希望對您有幫助！',
  
  '有推薦的早餐店嗎？': '文山特區有幾家不錯的早餐店：尋早早餐-鳳山店、Da Da\'s Kitchen、Ease等，提供豐富的早餐選擇。建議您使用Google Maps查詢具體位置和營業時間。',
  
  '有日式料理嗎？': '有的！文山特區有幾家不錯的日式料理：スシロー壽司郎 高雄鳳山店（壽司）、一燒丼飯專賣（丼飯）、一魂 いざかや（居酒屋）、夜葉食堂鳳山店（日式料理）、食事處櫻廷（日式料理）等。',
  
  '有韓式料理嗎？': '抱歉，文山特區目前沒有找到韓式料理餐廳。不過我為您推薦幾家其他不錯的餐廳：スシロー壽司郎 高雄鳳山店、一燒丼飯專賣、一魂 いざかや等。如果您知道有韓式料理餐廳，歡迎推薦給我們新增喔～',
  
  '有泰式料理嗎？': '抱歉，文山特區目前沒有找到泰式料理餐廳。不過我為您推薦幾家其他不錯的餐廳：スシロー壽司郎 高雄鳳山店、一燒丼飯專賣、一魂 いざかや等。如果您知道有泰式料理餐廳，歡迎推薦給我們新增喔～',
  
  '有中式餐廳嗎？': '抱歉，文山特區目前沒有找到中式料理餐廳。不過我為您推薦幾家其他不錯的餐廳：スシロー壽司郎 高雄鳳山店、一燒丼飯專賣、一魂 いざかや等。如果您知道有中式料理餐廳，歡迎推薦給我們新增喔～',
  
  '有素食餐廳嗎？': '抱歉，文山特區目前沒有找到素食餐廳。建議您使用Google Maps查詢附近的素食餐廳，或詢問當地居民。如果您知道有素食餐廳，歡迎推薦給我們新增喔～',
  
  '推薦幾家咖啡廳': '抱歉，文山特區目前沒有找到咖啡廳。建議您使用Google Maps查詢附近的咖啡廳，或詢問當地居民。如果您知道有咖啡廳，歡迎推薦給我們新增喔～',
  
  '推薦幾家義大利麵店': '抱歉，文山特區目前沒有找到義大利麵店。建議您使用Google Maps查詢附近的義大利麵店，或詢問當地居民。如果您知道有義大利麵店，歡迎推薦給我們新增喔～',
  
  '有燒肉店嗎？': '抱歉，文山特區目前沒有找到燒肉店。建議您使用Google Maps查詢附近的燒肉店，或詢問當地居民。如果您知道有燒肉店，歡迎推薦給我們新增喔～',
  
  '有居酒屋嗎？': '有的！文山特區有一魂 いざかや（居酒屋），提供日式居酒屋料理。建議您使用Google Maps查詢具體位置和營業時間。',
  
  '哪裡有宵夜可以吃？': '抱歉，文山特區目前沒有找到宵夜餐廳。建議您使用Google Maps查詢附近的宵夜餐廳，或詢問當地居民。如果您知道有宵夜餐廳，歡迎推薦給我們新增喔～',

  // 停車資訊 (8題)
  '附近有停車場嗎？': '文山特區有38個停車場！我為您推薦幾個：鳳山車站地下停車場、大東文化藝術中心地下停車場、衛武營地下停車場、鳳山運動園區地下立體停車場、鳳山區公所附屬停車場等，都提供便利的停車服務。',
  
  '停車費怎麼算？': '抱歉，我目前沒有各停車場的詳細收費資訊。建議您直接詢問停車場管理員，或使用Google Maps查詢停車場資訊。',
  
  '有免費停車場嗎？': '抱歉，我目前沒有免費停車場的詳細資訊。建議您使用Google Maps查詢附近的停車場，或詢問當地居民。',
  
  '有地下停車場嗎？': '有的！文山特區有幾個地下停車場：鳳山車站地下停車場、大東文化藝術中心地下停車場、衛武營地下停車場等。建議您使用Google Maps查詢具體位置。',
  
  '停車場營業時間？': '抱歉，我目前沒有各停車場的詳細營業時間資訊。建議您直接詢問停車場管理員，或使用Google Maps查詢停車場資訊。',
  
  '有機車停車位嗎？': '抱歉，我目前沒有機車停車位的詳細資訊。建議您使用Google Maps查詢附近的停車場，或詢問當地居民。',
  
  '停車場有充電樁嗎？': '抱歉，我目前沒有停車場充電樁的詳細資訊。建議您使用Google Maps查詢附近的停車場，或詢問當地居民。',
  
  '有代客泊車服務嗎？': '抱歉，文山特區目前沒有找到代客泊車服務。建議您使用Google Maps查詢相關服務，或詢問當地居民。',

  // 購物消費 (8題)
  '附近有便利商店嗎？': '抱歉，文山特區目前沒有找到便利商店。建議您使用Google Maps查詢附近的便利商店，或詢問當地居民。如果您知道有便利商店，歡迎推薦給我們新增喔～',
  
  '有藥局嗎？': '有的！文山特區有4家藥局：赤山健保藥局、青年新高橋藥局、鳳山啤木鳥藥局、丁丁連鎖藥局 鳳山自由店等，提供藥品和健康用品，方便購買日常藥品。',
  
  '有書店嗎？': '有的！文山特區有5家書店：書瞧味 Books & Cafe（獨立書店）、甲群升學專業書局（學習書局）、統一書社（學習書局）、雄大書局（學習書局）、誠品生活衛武營等，提供豐富的書籍選擇。',
  
  '哪裡可以買衣服？': '抱歉，文山特區目前沒有找到服飾店。建議您使用Google Maps查詢附近的服飾店，或詢問當地居民。如果您知道有服飾店，歡迎推薦給我們新增喔～',
  
  '有超市嗎？': '抱歉，文山特區目前沒有找到超市。建議您使用Google Maps查詢附近的超市，或詢問當地居民。如果您知道有超市，歡迎推薦給我們新增喔～',
  
  '有美妝店嗎？': '抱歉，文山特區目前沒有找到美妝店。建議您使用Google Maps查詢附近的美妝店，或詢問當地居民。如果您知道有美妝店，歡迎推薦給我們新增喔～',
  
  '哪裡可以買鞋子？': '抱歉，文山特區目前沒有找到鞋店。建議您使用Google Maps查詢附近的鞋店，或詢問當地居民。如果您知道有鞋店，歡迎推薦給我們新增喔～',
  
  '有3C用品店嗎？': '抱歉，文山特區目前沒有找到3C用品店。建議您使用Google Maps查詢附近的3C用品店，或詢問當地居民。如果您知道有3C用品店，歡迎推薦給我們新增喔～',

  // 生活服務 (8題)
  '有銀行嗎？': '抱歉，文山特區目前沒有找到銀行。建議您使用Google Maps查詢附近的銀行，或詢問當地居民。如果您知道有銀行，歡迎推薦給我們新增喔～',
  
  '哪裡可以洗衣服？': '抱歉，文山特區目前沒有找到洗衣店。建議您使用Google Maps查詢附近的洗衣店，或詢問當地居民。如果您知道有洗衣店，歡迎推薦給我們新增喔～',
  
  '有郵局嗎？': '抱歉，文山特區目前沒有找到郵局。建議您使用Google Maps查詢附近的郵局，或詢問當地居民。如果您知道有郵局，歡迎推薦給我們新增喔～',
  
  '有加油站嗎？': '抱歉，文山特區目前沒有找到加油站。建議您使用Google Maps查詢附近的加油站，或詢問當地居民。如果您知道有加油站，歡迎推薦給我們新增喔～',
  
  '哪裡可以修手機？': '抱歉，文山特區目前沒有找到手機維修店。建議您使用Google Maps查詢附近的手機維修店，或詢問當地居民。如果您知道有手機維修店，歡迎推薦給我們新增喔～',
  
  '有影印店嗎？': '抱歉，文山特區目前沒有找到影印店。建議您使用Google Maps查詢附近的影印店，或詢問當地居民。如果您知道有影印店，歡迎推薦給我們新增喔～',
  
  '有快遞服務嗎？': '抱歉，文山特區目前沒有找到快遞服務。建議您使用Google Maps查詢附近的快遞服務，或詢問當地居民。如果您知道有快遞服務，歡迎推薦給我們新增喔～',
  
  '哪裡可以配鑰匙？': '抱歉，文山特區目前沒有找到配鑰匙服務。建議您使用Google Maps查詢附近的配鑰匙服務，或詢問當地居民。如果您知道有配鑰匙服務，歡迎推薦給我們新增喔～',

  // 醫療保健 (4題)
  '有診所嗎？': '抱歉，文山特區目前沒有找到診所。建議您使用Google Maps查詢附近的診所，或詢問當地居民。如果您知道有診所，歡迎推薦給我們新增喔～',
  
  '有牙醫嗎？': '抱歉，文山特區目前沒有找到牙醫診所。建議您使用Google Maps查詢附近的牙醫診所，或詢問當地居民。如果您知道有牙醫診所，歡迎推薦給我們新增喔～',
  
  '有眼科嗎？': '抱歉，文山特區目前沒有找到眼科診所。建議您使用Google Maps查詢附近的眼科診所，或詢問當地居民。如果您知道有眼科診所，歡迎推薦給我們新增喔～',
  
  '有中醫診所嗎？': '抱歉，文山特區目前沒有找到中醫診所。建議您使用Google Maps查詢附近的中醫診所，或詢問當地居民。如果您知道有中醫診所，歡迎推薦給我們新增喔～',

  // 休閒娛樂 (2題)
  '有公園嗎？': '有的！文山特區有2個公園：鳳山公園（休閒公園）、鳳山運動公園（運動公園）等，提供綠地休憩和運動空間，是放鬆身心的好去處。',
  
  '有圖書館嗎？': '抱歉，文山特區目前沒有找到圖書館。建議您使用Google Maps查詢附近的圖書館，或詢問當地居民。如果您知道有圖書館，歡迎推薦給我們新增喔～'
}

async function updateFAQAnswers() {
  console.log('🔧 更新42題FAQ答案，提供基於實際商家數據的準確回答...')
  
  try {
    // 獲取需要更新的FAQ
    const { data: faqsToUpdate, error: fetchError } = await supabase
      .from('faqs')
      .select('*')
      .eq('is_active', true)
      .like('answer', '%抱歉，我目前沒有這方面的詳細資訊%')
    
    if (fetchError) {
      console.error('❌ 查詢失敗:', fetchError)
      return
    }
    
    console.log(`📊 找到 ${faqsToUpdate.length} 題需要更新的FAQ`)
    
    // 逐個更新答案
    let successCount = 0
    let errorCount = 0
    
    for (const faq of faqsToUpdate) {
      const accurateAnswer = accurateAnswers[faq.question]
      
      if (accurateAnswer) {
        const { error: updateError } = await supabase
          .from('faqs')
          .update({
            answer: accurateAnswer,
            updated_at: new Date().toISOString()
          })
          .eq('id', faq.id)
        
        if (updateError) {
          console.error(`❌ 更新失敗 (ID: ${faq.id}):`, updateError.message)
          errorCount++
        } else {
          console.log(`✅ 更新成功: ${faq.question}`)
          successCount++
        }
      } else {
        console.log(`⚠️ 未找到答案模板: ${faq.question}`)
        errorCount++
      }
    }
    
    console.log(`\n📊 更新結果: 成功 ${successCount} 題，失敗 ${errorCount} 題`)
    
    if (successCount > 0) {
      console.log('✅ 成功更新FAQ答案！')
      console.log('📝 更新特點:')
      console.log('   - 基於實際商家數據提供準確答案')
      console.log('   - 誠實承認沒有資料的情況')
      console.log('   - 引導用戶使用其他方式查詢')
      console.log('   - 鼓勵用戶推薦新商家')
    }
    
  } catch (error) {
    console.error('❌ 更新過程發生錯誤:', error)
  }
}

// 執行更新
updateFAQAnswers()


