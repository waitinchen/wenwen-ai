// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./data/memory/wenwen-memory.db"
}

model Merchant {
  id                String   @id @default(cuid())
  storeName         String   @map("store_name")
  owner             String?
  role              String?
  category          String?
  address           String?
  phone             String?
  businessHours     String?  @map("business_hours")
  services          String?
  features          String?
  isSafeStore       Boolean  @default(false) @map("is_safe_store")
  hasMemberDiscount Boolean  @default(false) @map("has_member_discount")
  isPartnerStore    Boolean  @default(false) @map("is_partner_store")
  facebookUrl       String?  @map("facebook_url")
  websiteUrl        String?  @map("website_url")
  status            MerchantStatus @default(ACTIVE)
  createdAt         DateTime @default(now()) @map("created_at")
  updatedAt         DateTime @updatedAt @map("updated_at")
  
  // Relations - 暫時移除，專注於記憶功能
  
  @@map("merchants")
}

enum MerchantStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
  PENDING
}

// 高文文長記憶模型
model MemoryItem {
  id          String   @id @default(cuid())
  userId      String   @map("user_id")           // 用戶ID
  sessionId   String?  @map("session_id")        // 會話ID
  content     String                              // 記憶內容（已加密）
  summary     String?                             // 摘要（已加密）
  intent      String?                             // 意圖分類
  keywords    String?                             // 關鍵字（JSON）
  meta        String?                             // 元資料（JSON）
  encrypted   Boolean  @default(true)            // 是否加密
  expiresAt   DateTime? @map("expires_at")       // 到期時間
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  
  @@map("memory_items")
  @@index([userId])
  @@index([sessionId])
  @@index([expiresAt])
}
